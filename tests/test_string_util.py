from utils.string_util import sql_result_to_csv


def test_sql_result_to_csv():
    s = """
+-----------+-----------+-------+
|status_code|status_code|    cnt|
+-----------+-----------+-------+
|        499|        499|     85|
|        502|        502|   3677|
|        504|        504|   7233|
|        500|        500|     14|
|        200|        200|5996872|
|        403|        403|    380|
|        503|        503| 139826|
+-----------+-----------+-------+"""

    ret = b"""status_code,status_code,cnt
499,499,85
502,502,3677
504,504,7233
500,500,14
200,200,5996872
403,403,380
503,503,139826"""

    assert ret == sql_result_to_csv(s)
